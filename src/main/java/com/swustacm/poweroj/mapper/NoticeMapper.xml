<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.swustacm.poweroj.mapper.NoticeMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.swustacm.poweroj.notice.entity.Notice">
        <id column="id" property="id" />
        <result column="uid" property="uid" />
        <result column="editorUid" property="editorUid" />
        <result column="cid" property="cid" />
        <result column="title" property="title" />
        <result column="startTime" property="startTime" />
        <result column="endTime" property="endTime" />
        <result column="content" property="content" />
        <result column="atime" property="atime" />
        <result column="ctime" property="ctime" />
        <result column="mtime" property="mtime" />
        <result column="view" property="view" />
        <result column="status" property="status" />
    </resultMap>
    <select id="getNotice" resultType="com.swustacm.poweroj.notice.entity.Notice">
    SELECT
	    n.*,
	    u.NAME,
	    FROM_UNIXTIME( startTime, '%Y-%m-%d %H:%i:%s' ) AS startDateTime,
        FROM_UNIXTIME( endTime, '%Y-%m-%d %H:%i:%s' ) AS endDateTime
    FROM
	    notice n
	    INNER JOIN USER u ON u.uid = n.uid
    WHERE
	    id = #{id}
    </select>
    <select id="getAllNotices" resultType="com.swustacm.poweroj.notice.entity.Notice">
        SELECT
        notice.id,
        USER.NAME as publisher,
        notice.title,
        notice.status,
        FROM_UNIXTIME( startTime, '%Y-%m-%d %H:%i:%s' ) AS startTime,
        FROM_UNIXTIME( endTime, '%Y-%m-%d %H:%i:%s' )AS endTime
        FROM
        notice
        LEFT JOIN USER ON notice.uid = USER.uid
	<if test="notAdmin!=null">
        where notice.status=1
    </if>
    ORDER BY
	    id DESC
    </select>


</mapper>
